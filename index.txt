<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ üí∞</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #ffe2d1; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏£‡∏∞‡∏ö‡∏∏ [cite: 495, 496] */
            --surface-color: #FFFFFF;
            --text-color: #3D2C2E;
            --primary-color: #E8734A; /* ‡∏™‡∏µ‡∏™‡πâ‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≥‡∏Å‡∏£‡∏≠‡∏ö [cite: 497] */
            --secondary-color: #F4A261;
            --border-color: #E8D5C4;
        }

        /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô #ffe2d1 ‡∏ó‡∏±‡πà‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤  */
        html, body {
            background-color: var(--bg-color) !important;
            margin: 0; padding: 0; min-height: 100%;
        }

        body { 
            font-family: 'Sarabun', 'Prompt', sans-serif; [cite: 500]
            color: var(--text-color);
            padding: 20px 16px; 
        }

        .container { max-width: 900px; margin: 0 auto; [cite: 501] }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏ö Card ‡∏ó‡∏∏‡∏Å‡πÉ‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏™‡πâ‡∏°‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£  */
        .card {
            background: var(--surface-color);
            border-radius: 16px;
            box-shadow: 0 2px 16px rgba(61,44,46,0.07);
            padding: 24px; margin-bottom: 20px; 
            border: 2px solid var(--primary-color); /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡πâ‡∏°‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á */
        }

        .section-title { 
            font-size: 18px; font-weight: 700; color: var(--text-color); [cite: 504]
            margin-bottom: 16px; display: flex; align-items: center; gap: 8px; [cite: 505]
        }

        .input-field {
            width: 100%; padding: 10px 14px; border: 2px solid var(--border-color); [cite: 506]
            border-radius: 10px; font-family: inherit; background: #FFFCF9; outline: none; box-sizing: border-box;
            transition: border-color 0.2s; [cite: 507]
        }
        .input-field:focus { border-color: var(--primary-color); [cite: 508] }

        .btn-primary {
            background: var(--primary-color); color: white; border: none; [cite: 509]
            border-radius: 12px; padding: 12px 24px; font-weight: 600; cursor: pointer;
            transition: all 0.2s; [cite: 510]
        }

        .summary-card { padding: 16px; border-radius: 14px; text-align: center; font-weight: bold; [cite: 521] }
        .txt-‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö { color: #1B8C5A; font-weight: bold; [cite: 522] }
        .txt-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ { color: #E74C3C; font-weight: bold; [cite: 523] }
    </style>
</head>
<body>

<div class="container">
    <header style="text-align:center; margin-bottom:30px;">
        <h1 style="font-size:28px; font-weight:700;">üìí ‡∏™‡∏°‡∏∏‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h1>
        <p style="color:#9B8578;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å‡∏ö‡∏≤‡∏ó ‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</p>
    </header>

    <div class="card">
        <div class="section-title">üè¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <input type="text" id="newAcc" class="input-field" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏™‡∏¥‡∏Å‡∏£" style="flex:2">
            <button onclick="addAccount()" class="btn-primary" style="flex:1">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</button>
        </div>
        <div id="accBadges" style="margin-top:15px; display:flex; gap:8px; flex-wrap:wrap;"></div> [cite: 530]
    </div>

    <div class="card">
        <div class="section-title">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
            <div class="summary-card" style="background: #E8F8F0; color: #1B8C5A;">
                <div style="font-size: 12px; opacity: 0.8;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°</div> [cite: 525]
                <div id="totalIncome">0.00 ‡∏ø</div>
            </div>
            <div class="summary-card" style="background: #FDECEC; color: #E74C3C;">
                <div style="font-size: 12px; opacity: 0.8;">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div> [cite: 526]
                <div id="totalExpense">0.00 ‡∏ø</div>
            </div>
            <div class="summary-card" style="background: #EBF0FF; color: #3B5BDB;">
                <div style="font-size: 12px; opacity: 0.8;">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</div> [cite: 528]
                <div id="netBalance">0.00 ‡∏ø</div>
            </div>
        </div>
    </div>

    <div id="accCards" style="display: flex; gap: 12px; overflow-x: auto; margin-bottom: 20px; padding-bottom: 10px;"></div>

    <div class="card">
        <div class="section-title">üìù ‡∏•‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <div><label style="font-size:13px; font-weight:600;">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label><input type="date" id="date" class="input-field"></div> [cite: 533]
            <div><label style="font-size:13px; font-weight:600;">üè¶ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</label><select id="accSelect" class="input-field"></select></div> [cite: 534]
            <div><label style="font-size:13px; font-weight:600;">üìä ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label><select id="type" class="input-field"><option value="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö (+)</option><option value="‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢" selected>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (-)</option></select></div> [cite: 535]
            <div><label style="font-size:13px; font-weight:600;">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</label><input type="text" id="desc" class="input-field" placeholder="‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£ üç±"></div> [cite: 536]
            <div><label style="font-size:13px; font-weight:600;">üíµ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label><input type="number" id="amt" class="input-field" placeholder="0.00"></div> [cite: 537]
        </div>
        <button class="btn-primary" onclick="saveData()" style="width:100%; margin-top:20px; font-size:16px; justify-content:center;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ üí∞</button> [cite: 539]
    </div>
</div>

<script>
    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) [cite: 549]
    let accounts = JSON.parse(localStorage.getItem('FIN_V6_ACCS')) || ['‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î üíµ', '‡∏Å‡∏™‡∏¥‡∏Å‡∏£ üè¶'];
    let logs = JSON.parse(localStorage.getItem('FIN_V6_LOGS')) || [];

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á ID ‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á input ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô) [cite: 550]
    function addAccount() {
        const input = document.getElementById('newAcc');
        let name = input.value.trim();
        if(name && !accounts.includes(name)) {
            accounts.push(name);
            input.value = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å [cite: 551]
            saveAndUI();
        }
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 
    function saveAndUI() { 
        localStorage.setItem('FIN_V6_ACCS', JSON.stringify(accounts));
        localStorage.setItem('FIN_V6_LOGS', JSON.stringify(logs));
        updateUI();
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÄ‡∏ß‡πá‡∏ö [cite: 563]
    function updateUI() {
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
        document.getElementById('accSelect').innerHTML = accounts.map(a => `<option value="${a}">${a}</option>`).join('');
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡πâ‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö [cite: 564]
        document.getElementById('accBadges').innerHTML = accounts.map(a => `
            <span style="background:#F0E6DC; padding:6px 12px; border-radius:20px; font-size:13px; font-weight:600;">
                ${a} <b onclick="removeAccount('${a}')" style="color:red; cursor:pointer; margin-left:5px;">√ó</b>
            </span>`).join('');

        // ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ [cite: 566]
        let bals = {}; accounts.forEach(a => bals[a] = 0);
        logs.forEach(l => {
            if(l.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö') bals[l.acc] += l.amt;
            else bals[l.acc] -= l.amt;
        });

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Card ‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ [cite: 571]
        document.getElementById('accCards').innerHTML = accounts.map(a => `
            <div style="min-width:160px; background:linear-gradient(135deg, var(--secondary-color), var(--primary-color)); color:white; padding:18px; border-radius:14px; text-align:center;">
                <div style="font-size:13px; opacity:0.9;">${a}</div>
                <div style="font-size:20px; font-weight:700; margin-top:5px;">${(bals[a] || 0).toLocaleString()} ‡∏ø</div>
            </div>`).join('');
            
        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° Dashboard [cite: 568, 569, 570]
        let sumIn = 0, sumOut = 0;
        logs.forEach(l => { if(l.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö') sumIn += l.amt; else sumOut += l.amt; });
        document.getElementById('totalIncome').textContent = sumIn.toLocaleString() + " ‡∏ø";
        document.getElementById('totalExpense').textContent = sumOut.toLocaleString() + " ‡∏ø";
        document.getElementById('netBalance').textContent = (sumIn - sumOut).toLocaleString() + " ‡∏ø";
    }

    function removeAccount(name) { [cite: 552]
        if(confirm(`‡∏•‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ${name}? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ`)) {
            accounts = accounts.filter(a => a !== name);
            saveAndUI();
        }
    }

    function saveData() { [cite: 553]
        let amt = parseFloat(document.getElementById('amt').value) || 0;
        if(amt <= 0) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô");
        
        logs.push({ 
            id: Date.now(), 
            date: document.getElementById('date').value, 
            acc: document.getElementById('accSelect').value, 
            type: document.getElementById('type').value, 
            desc: document.getElementById('desc').value || "‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", 
            amt: amt 
        });
        document.getElementById('amt').value = '';
        saveAndUI();
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô UI ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    updateUI();
</script>
</body>
</html>